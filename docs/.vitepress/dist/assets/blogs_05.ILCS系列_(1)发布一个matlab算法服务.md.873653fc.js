import{_ as s,o as a,c as n,a as l}from"./app.10eb149d.js";const i=JSON.parse('{"title":"如何在ILCS中发布一个matlab算法服务","description":"","frontmatter":{},"headers":[{"level":2,"title":"1.准备算法文件","slug":"_1-准备算法文件","link":"#_1-准备算法文件","children":[{"level":3,"title":"1.1 CVA  运行 matlab","slug":"_1-1-cva-运行-matlab","link":"#_1-1-cva-运行-matlab","children":[]},{"level":3,"title":"1.2 OTSU 运行 matlab","slug":"_1-2-otsu-运行-matlab","link":"#_1-2-otsu-运行-matlab","children":[]}]},{"level":2,"title":"2 改造算法文件","slug":"_2-改造算法文件","link":"#_2-改造算法文件","children":[{"level":3,"title":"2.1注释掉 所有 imshow 界面显示的函数","slug":"_2-1注释掉-所有-imshow-界面显示的函数","link":"#_2-1注释掉-所有-imshow-界面显示的函数","children":[]},{"level":3,"title":"2.2 将算法改为函数执行方式","slug":"_2-2-将算法改为函数执行方式","link":"#_2-2-将算法改为函数执行方式","children":[]},{"level":3,"title":"2.3 以函数执行 进行测试","slug":"_2-3-以函数执行-进行测试","link":"#_2-3-以函数执行-进行测试","children":[]}]},{"level":2,"title":"3  mcc编译jar","slug":"_3-mcc编译jar","link":"#_3-mcc编译jar","children":[{"level":3,"title":"3.1成功运行后 对其进行打包","slug":"_3-1成功运行后-对其进行打包","link":"#_3-1成功运行后-对其进行打包","children":[]},{"level":3,"title":"3.2 打包内容","slug":"_3-2-打包内容","link":"#_3-2-打包内容","children":[]}]},{"level":2,"title":"4 利用52N包装算法","slug":"_4-利用52n包装算法","link":"#_4-利用52n包装算法","children":[{"level":3,"title":"4.1 新建一个java文件","slug":"_4-1-新建一个java文件","link":"#_4-1-新建一个java文件","children":[]},{"level":3,"title":"4.2 将打包算法copy到项目的lib目录下","slug":"_4-2-将打包算法copy到项目的lib目录下","link":"#_4-2-将打包算法copy到项目的lib目录下","children":[]},{"level":3,"title":"4.3 “注册”算法","slug":"_4-3-注册-算法","link":"#_4-3-注册-算法","children":[]},{"level":3,"title":"4.4 GetCapabilities 查看是否注册","slug":"_4-4-getcapabilities-查看是否注册","link":"#_4-4-getcapabilities-查看是否注册","children":[]},{"level":3,"title":"4.5 执行wps算法服务","slug":"_4-5-执行wps算法服务","link":"#_4-5-执行wps算法服务","children":[]},{"level":3,"title":"4.7 服务执行代码","slug":"_4-7-服务执行代码","link":"#_4-7-服务执行代码","children":[]}]},{"level":2,"title":"5 测试服务接口","slug":"_5-测试服务接口","link":"#_5-测试服务接口","children":[{"level":3,"title":"5.1 注册算法","slug":"_5-1-注册算法","link":"#_5-1-注册算法","children":[]},{"level":3,"title":"5.2 getcapabilities","slug":"_5-2-getcapabilities","link":"#_5-2-getcapabilities","children":[]},{"level":3,"title":"5.3 执行测试 Execute","slug":"_5-3-执行测试-execute","link":"#_5-3-执行测试-execute","children":[]}]},{"level":2,"title":"6 界面化","slug":"_6-界面化","link":"#_6-界面化","children":[]}],"relativePath":"blogs/05.ILCS系列/(1)发布一个matlab算法服务.md"}'),p={name:"blogs/05.ILCS系列/(1)发布一个matlab算法服务.md"},o=l(`<h1 id="如何在ilcs中发布一个matlab算法服务" tabindex="-1">如何在ILCS中发布一个matlab算法服务 <a class="header-anchor" href="#如何在ilcs中发布一个matlab算法服务" aria-hidden="true">#</a></h1><hr><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>注意： /<strong>2022-04-23　王海航</strong>/</p><p>1 不同版本的MCR和JDK编译的文件存在执行差异</p><p>2 打包好算法后先查看doc下的文档 查看class中是否编译好了执行函数的输入参数，如: OTSU(int, Object...) - matlab.OTSU.Matlab Provides the standard interface for calling the OTSU MATLAB function with 2 comma-separated input arguments.</p><p>3 在IDEA控制台中，空指针异常，检查请求XML配置文件</p></div><h2 id="_1-准备算法文件" tabindex="-1">1.准备算法文件 <a class="header-anchor" href="#_1-准备算法文件" aria-hidden="true">#</a></h2><h3 id="_1-1-cva-运行-matlab" tabindex="-1">1.1 CVA 运行 matlab <a class="header-anchor" href="#_1-1-cva-运行-matlab" aria-hidden="true">#</a></h3><div class="language-matlab"><button title="Copy Code" class="copy"></button><span class="lang">matlab</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">A1 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">131.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">A2 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">132.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">A3 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">133.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">A4 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">134.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">A5 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">135.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">A6 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">136.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">A7 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">137.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">B1 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">181.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">B2 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">182.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">B3 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">183.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">B4 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">184.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">B5 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">185.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">B6 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">186.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">B7 = imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">187.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">[I,R] = geotiffread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">187.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">info = geotiffinfo(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\data</span><span style="color:#A6ACCD;">\\t</span><span style="color:#C3E88D;">187.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">A1=double(A1);A2=double(A2);A3=double(A3);A4=double(A4);A5=double(A5);A6=double(A6);A7=double(A7);</span></span>
<span class="line"><span style="color:#A6ACCD;">B1=double(B1);B2 =double(B2);B3 =double(B3);B4 =double(B4);B5 =double(B5);B6 =double(B6);B7=double(B7);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">C=sqrt((B1-A1).^2+(B2-A2).^2+(B3-A3).^2+(B4-A4).^2+(B5-A5).^2+(B6-A6).^2+(B7-A7).^2);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> amax = max(max(C));   </span></span>
<span class="line"><span style="color:#A6ACCD;">amin = min(min(C));  </span></span>
<span class="line"><span style="color:#A6ACCD;">a1=</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">*(C-amin)/(amax-amin); </span></span>
<span class="line"><span style="color:#A6ACCD;">a1=uint8(a1);</span></span>
<span class="line"><span style="color:#A6ACCD;">imshow(a1);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">outraster = a1;</span></span>
<span class="line"><span style="color:#A6ACCD;">filename = </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">geotiffwrite(filename, outraster,R, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GeoKeyDirectoryTag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, info.GeoTIFFTags.GeoKeyDirectoryTag);</span></span>
<span class="line"></span></code></pre></div><h4 id="输出结果" tabindex="-1">输出结果 <a class="header-anchor" href="#输出结果" aria-hidden="true">#</a></h4><h3 id="_1-2-otsu-运行-matlab" tabindex="-1">1.2 OTSU 运行 matlab <a class="header-anchor" href="#_1-2-otsu-运行-matlab" aria-hidden="true">#</a></h3><p>cva的输出作为OTSU的输入</p><div class="language-matlab"><button title="Copy Code" class="copy"></button><span class="lang">matlab</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">I=im2double(imread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">));  </span><span style="color:#676E95;">%变为双精度，即0-1</span></span>
<span class="line"><span style="color:#A6ACCD;">subplot(</span><span style="color:#F78C6C;">221</span><span style="color:#A6ACCD;">);imhist(I);            </span><span style="color:#676E95;">%显示灰度直方图</span></span>
<span class="line"><span style="color:#A6ACCD;">[M,N]=size(I);                     </span><span style="color:#676E95;">%得到图像行列像素</span></span>
<span class="line"><span style="color:#A6ACCD;">number_all=M*N;                    </span><span style="color:#676E95;">%总像素值</span></span>
<span class="line"><span style="color:#A6ACCD;">hui_all=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                         </span><span style="color:#676E95;">%预设图像总灰度值为0</span></span>
<span class="line"><span style="color:#A6ACCD;">ICV_t=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                           </span><span style="color:#676E95;">%预设最大方差为0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">%得到图像总灰度值</span></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:M</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> j=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:N</span></span>
<span class="line"><span style="color:#A6ACCD;">        hui_all=hui_all+I(i,j);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">all_ave=hui_all*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">/number_all;   </span><span style="color:#676E95;">%图像灰度值的总平均值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">%t为某个阈值，把原图像分为A部分（每个像素值&gt;=t）与B部分（每个像素值&lt;t）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> t=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">:</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">                       </span><span style="color:#676E95;">%不断试探最优t值</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">% for  t2=1:255</span></span>
<span class="line"><span style="color:#A6ACCD;">    hui_A=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                      </span><span style="color:#676E95;">%不断重置A部分总灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">    hui_B=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;        </span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">%   hui_C=0;</span></span>
<span class="line"><span style="color:#A6ACCD;">    number_A=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                   </span><span style="color:#676E95;">%不断重置A部分总像素</span></span>
<span class="line"><span style="color:#A6ACCD;">    number_B=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                   </span><span style="color:#676E95;">%不断重置B部分总像素</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">%    number_C=0;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:M                     </span><span style="color:#676E95;">%遍历原图像每个像素的灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> j=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:N</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> (I(i,j)*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">&gt;=t)    </span><span style="color:#676E95;">%分割出灰度值》=t的像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                number_A=number_A+</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;  </span><span style="color:#676E95;">%得到A部分总像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                hui_A=hui_A+I(i,j);   </span><span style="color:#676E95;">%得到A部分总灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">elseif</span><span style="color:#A6ACCD;"> (I(i,j)*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">&lt;t) </span><span style="color:#676E95;">%分割出灰度值《t的像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                number_B=number_B+</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;  </span><span style="color:#676E95;">%得到B部分总像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                hui_B=hui_B+I(i,j);   </span><span style="color:#676E95;">%得到B部分总灰度值</span></span>
<span class="line"><span style="color:#89DDFF;">                 </span><span style="color:#676E95;">%           elseif (I(i,j)*255&gt;t1 &amp;&amp; I(i,j)*255&lt;t2) %分割出灰度值《t的像素</span></span>
<span class="line"><span style="color:#89DDFF;">                   </span><span style="color:#676E95;">%                 number_C=number_C+1;  %得到B部分总像素</span></span>
<span class="line"><span style="color:#89DDFF;">                    </span><span style="color:#676E95;">%                hui_C=hui_C+I(i,j);   %得到B部分总灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#676E95;">%  end</span></span>
<span class="line"><span style="color:#A6ACCD;">    PA=number_A/number_all;            </span><span style="color:#676E95;">%得到A部分像素总数与图像总像素的比列</span></span>
<span class="line"><span style="color:#A6ACCD;">    PB=number_B/number_all;            </span><span style="color:#676E95;">%得到B部分像素总数与图像总像素的比列</span></span>
<span class="line"><span style="color:#89DDFF;">   </span><span style="color:#676E95;">%   PC=number_C/number_all;</span></span>
<span class="line"><span style="color:#A6ACCD;">    A_ave=hui_A*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">/number_A;          </span><span style="color:#676E95;">%得到A部分总灰度值与A部分总像素的比例</span></span>
<span class="line"><span style="color:#A6ACCD;">    B_ave=hui_B*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">/number_B;          </span><span style="color:#676E95;">%得到B部分总灰度值与B部分总像素的比例</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">%    C_ave=hui_C*255/number_C;</span></span>
<span class="line"><span style="color:#A6ACCD;">    ICV=PA*((A_ave-all_ave)^2)+PB*((B_ave-all_ave)^2); </span><span style="color:#676E95;">%+PC*((C_ave-all_ave)^2);  %Otsu算法</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> (ICV&gt;ICV_t)                     </span><span style="color:#676E95;">%不断判断，得到最大方差</span></span>
<span class="line"><span style="color:#A6ACCD;">        ICV_t=ICV;</span></span>
<span class="line"><span style="color:#A6ACCD;">        k=t;                           </span><span style="color:#676E95;">%得到最大方差的最优阈值</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">[I,R] = geotiffread(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">info = geotiffinfo(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Th=k;</span></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:M</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> j=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:N</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> I(i,j)&gt;=Th</span></span>
<span class="line"><span style="color:#A6ACCD;">            I(i,j)=</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">            I(i,j)=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">figure,imshow(I);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">outraster = I;</span></span>
<span class="line"><span style="color:#676E95;">%imagesc(outraster);</span></span>
<span class="line"><span style="color:#A6ACCD;">filename = </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:\\ILCS4MatlabService\\CVA-OSTU\\OTSU_Result\\OTSU_Res.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">geotiffwrite(filename, outraster,R, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GeoKeyDirectoryTag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, info.GeoTIFFTags.GeoKeyDirectoryTag);</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h4 id="运行结果" tabindex="-1">运行结果 <a class="header-anchor" href="#运行结果" aria-hidden="true">#</a></h4><h2 id="_2-改造算法文件" tabindex="-1">2 改造算法文件 <a class="header-anchor" href="#_2-改造算法文件" aria-hidden="true">#</a></h2><h3 id="_2-1注释掉-所有-imshow-界面显示的函数" tabindex="-1">2.1注释掉 所有 imshow 界面显示的函数 <a class="header-anchor" href="#_2-1注释掉-所有-imshow-界面显示的函数" aria-hidden="true">#</a></h3><h3 id="_2-2-将算法改为函数执行方式" tabindex="-1">2.2 将算法改为函数执行方式 <a class="header-anchor" href="#_2-2-将算法改为函数执行方式" aria-hidden="true">#</a></h3><p>其中r为返回值 - 将计算得到的阈值作为返回值 CVA</p><div class="language-matlab"><button title="Copy Code" class="copy"></button><span class="lang">matlab</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">r</span><span style="color:#A6ACCD;"> = </span><span style="color:#82AAFF;">CVA</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">pa1</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pa2</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pa3</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pa4</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pa5</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pa6</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pa7</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pb1</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pb2</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pb3</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pb4</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pb5</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pb6</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">pb7</span><span style="color:#A6ACCD;">,</span><span style="color:#A6ACCD;">res</span><span style="color:#A6ACCD;">) </span></span>
<span class="line"><span style="color:#676E95;">%A1 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t131.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%A2 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t132.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%A3 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t133.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%A4 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t134.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%A5 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t135.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%A6 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t136.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%A7 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t137.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%B1 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t181.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%B2 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t182.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%B3 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t183.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%B4 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t184.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%B5 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t185.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%B6 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t186.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%B7 = imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t187.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%[I,R] = geotiffread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t187.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%info = geotiffinfo(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t187.tif&#39;);</span></span>
<span class="line"><span style="color:#A6ACCD;">A1 = imread(pa1);</span></span>
<span class="line"><span style="color:#A6ACCD;">A2 = imread(pa2);</span></span>
<span class="line"><span style="color:#A6ACCD;">A3 = imread(pa3);</span></span>
<span class="line"><span style="color:#A6ACCD;">A4 = imread(pa4);</span></span>
<span class="line"><span style="color:#A6ACCD;">A5 = imread(pa5);</span></span>
<span class="line"><span style="color:#A6ACCD;">A6 = imread(pa6);</span></span>
<span class="line"><span style="color:#A6ACCD;">A7 = imread(pa7);</span></span>
<span class="line"><span style="color:#A6ACCD;">B1 = imread(pb1);</span></span>
<span class="line"><span style="color:#A6ACCD;">B2 = imread(pb2);</span></span>
<span class="line"><span style="color:#A6ACCD;">B3 = imread(pb3);</span></span>
<span class="line"><span style="color:#A6ACCD;">B4 = imread(pb4);</span></span>
<span class="line"><span style="color:#A6ACCD;">B5 = imread(pb5);</span></span>
<span class="line"><span style="color:#A6ACCD;">B6 = imread(pb6);</span></span>
<span class="line"><span style="color:#A6ACCD;">B7 = imread(pb7);</span></span>
<span class="line"><span style="color:#A6ACCD;">[I,R] = geotiffread(pb7);</span></span>
<span class="line"><span style="color:#A6ACCD;">info = geotiffinfo(pb7);</span></span>
<span class="line"><span style="color:#A6ACCD;">A1=double(A1);A2=double(A2);A3=double(A3);A4=double(A4);A5=double(A5);A6=double(A6);A7=double(A7);</span></span>
<span class="line"><span style="color:#A6ACCD;">B1=double(B1);B2 =double(B2);B3 =double(B3);B4 =double(B4);B5 =double(B5);B6 =double(B6);B7=double(B7);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">C=sqrt((B1-A1).^2+(B2-A2).^2+(B3-A3).^2+(B4-A4).^2+(B5-A5).^2+(B6-A6).^2+(B7-A7).^2);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> amax = max(max(C));   </span></span>
<span class="line"><span style="color:#A6ACCD;">amin = min(min(C));  </span></span>
<span class="line"><span style="color:#A6ACCD;">a1=</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">*(C-amin)/(amax-amin); </span></span>
<span class="line"><span style="color:#A6ACCD;">a1=uint8(a1);</span></span>
<span class="line"><span style="color:#676E95;">%imshow(a1);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">outraster = a1;</span></span>
<span class="line"><span style="color:#A6ACCD;">filename =res;</span></span>
<span class="line"><span style="color:#676E95;">%filename = &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;">geotiffwrite(filename, outraster,R, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GeoKeyDirectoryTag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, info.GeoTIFFTags.GeoKeyDirectoryTag);</span></span>
<span class="line"><span style="color:#A6ACCD;">r=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"></span></code></pre></div><div class="language-matlab"><button title="Copy Code" class="copy"></button><span class="lang">matlab</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">OTSU</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">r</span><span style="color:#A6ACCD;"> = </span><span style="color:#82AAFF;">OTSU</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">source</span><span style="color:#A6ACCD;">, </span><span style="color:#A6ACCD;">result</span><span style="color:#A6ACCD;">) </span></span>
<span class="line"><span style="color:#A6ACCD;">I=im2double(imread(source));</span><span style="color:#676E95;">%变为双精度，即0-1</span></span>
<span class="line"><span style="color:#676E95;">%I=im2double(imread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif&#39;));  %变为双精度，即0-1</span></span>
<span class="line"><span style="color:#676E95;">%subplot(221);imhist(I);            %显示灰度直方图</span></span>
<span class="line"><span style="color:#A6ACCD;">[M,N]=size(I);                     </span><span style="color:#676E95;">%得到图像行列像素</span></span>
<span class="line"><span style="color:#A6ACCD;">number_all=M*N;                    </span><span style="color:#676E95;">%总像素值</span></span>
<span class="line"><span style="color:#A6ACCD;">hui_all=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                         </span><span style="color:#676E95;">%预设图像总灰度值为0</span></span>
<span class="line"><span style="color:#A6ACCD;">ICV_t=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                           </span><span style="color:#676E95;">%预设最大方差为0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">%得到图像总灰度值</span></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:M</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> j=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:N</span></span>
<span class="line"><span style="color:#A6ACCD;">        hui_all=hui_all+I(i,j);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">all_ave=hui_all*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">/number_all;   </span><span style="color:#676E95;">%图像灰度值的总平均值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">%t为某个阈值，把原图像分为A部分（每个像素值&gt;=t）与B部分（每个像素值&lt;t）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> t=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">:</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">                       </span><span style="color:#676E95;">%不断试探最优t值</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">% for  t2=1:255</span></span>
<span class="line"><span style="color:#A6ACCD;">    hui_A=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                      </span><span style="color:#676E95;">%不断重置A部分总灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">    hui_B=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;        </span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">%   hui_C=0;</span></span>
<span class="line"><span style="color:#A6ACCD;">    number_A=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                   </span><span style="color:#676E95;">%不断重置A部分总像素</span></span>
<span class="line"><span style="color:#A6ACCD;">    number_B=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;                   </span><span style="color:#676E95;">%不断重置B部分总像素</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">%    number_C=0;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:M                     </span><span style="color:#676E95;">%遍历原图像每个像素的灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> j=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:N</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> (I(i,j)*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">&gt;=t)    </span><span style="color:#676E95;">%分割出灰度值》=t的像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                number_A=number_A+</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;  </span><span style="color:#676E95;">%得到A部分总像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                hui_A=hui_A+I(i,j);   </span><span style="color:#676E95;">%得到A部分总灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">elseif</span><span style="color:#A6ACCD;"> (I(i,j)*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">&lt;t) </span><span style="color:#676E95;">%分割出灰度值《t的像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                number_B=number_B+</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;  </span><span style="color:#676E95;">%得到B部分总像素</span></span>
<span class="line"><span style="color:#A6ACCD;">                hui_B=hui_B+I(i,j);   </span><span style="color:#676E95;">%得到B部分总灰度值</span></span>
<span class="line"><span style="color:#89DDFF;">                 </span><span style="color:#676E95;">%           elseif (I(i,j)*255&gt;t1 &amp;&amp; I(i,j)*255&lt;t2) %分割出灰度值《t的像素</span></span>
<span class="line"><span style="color:#89DDFF;">                   </span><span style="color:#676E95;">%                 number_C=number_C+1;  %得到B部分总像素</span></span>
<span class="line"><span style="color:#89DDFF;">                    </span><span style="color:#676E95;">%                hui_C=hui_C+I(i,j);   %得到B部分总灰度值</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#676E95;">%  end</span></span>
<span class="line"><span style="color:#A6ACCD;">    PA=number_A/number_all;            </span><span style="color:#676E95;">%得到A部分像素总数与图像总像素的比列</span></span>
<span class="line"><span style="color:#A6ACCD;">    PB=number_B/number_all;            </span><span style="color:#676E95;">%得到B部分像素总数与图像总像素的比列</span></span>
<span class="line"><span style="color:#89DDFF;">   </span><span style="color:#676E95;">%   PC=number_C/number_all;</span></span>
<span class="line"><span style="color:#A6ACCD;">    A_ave=hui_A*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">/number_A;          </span><span style="color:#676E95;">%得到A部分总灰度值与A部分总像素的比例</span></span>
<span class="line"><span style="color:#A6ACCD;">    B_ave=hui_B*</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">/number_B;          </span><span style="color:#676E95;">%得到B部分总灰度值与B部分总像素的比例</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">%    C_ave=hui_C*255/number_C;</span></span>
<span class="line"><span style="color:#A6ACCD;">    ICV=PA*((A_ave-all_ave)^2)+PB*((B_ave-all_ave)^2); </span><span style="color:#676E95;">%+PC*((C_ave-all_ave)^2);  %Otsu算法</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> (ICV&gt;ICV_t)                     </span><span style="color:#676E95;">%不断判断，得到最大方差</span></span>
<span class="line"><span style="color:#A6ACCD;">        ICV_t=ICV;</span></span>
<span class="line"><span style="color:#A6ACCD;">        k=t;                           </span><span style="color:#676E95;">%得到最大方差的最优阈值</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">[I,R] = geotiffread(source);</span></span>
<span class="line"><span style="color:#A6ACCD;">info = geotiffinfo(source);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">%[I,R] = geotiffread(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif&#39;);</span></span>
<span class="line"><span style="color:#676E95;">%info = geotiffinfo(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Th=k;</span></span>
<span class="line"><span style="color:#A6ACCD;">fprintf(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">阈值Th=</span><span style="color:#A6ACCD;">%f</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, Th);</span></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> i=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:M</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> j=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">:N</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> I(i,j)&gt;=Th</span></span>
<span class="line"><span style="color:#A6ACCD;">            I(i,j)=</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">            I(i,j)=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"><span style="color:#676E95;">%figure,imshow(I);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">outraster = I;</span></span>
<span class="line"><span style="color:#676E95;">%imagesc(outraster);</span></span>
<span class="line"><span style="color:#676E95;">%filename = &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\OTSU_Result\\OTSU_Res.tif&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;">filename = result;</span></span>
<span class="line"><span style="color:#A6ACCD;">geotiffwrite(filename, outraster,R, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GeoKeyDirectoryTag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, info.GeoTIFFTags.GeoKeyDirectoryTag);</span></span>
<span class="line"><span style="color:#A6ACCD;">r=Th;</span></span>
<span class="line"><span style="color:#89DDFF;">end</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-3-以函数执行-进行测试" tabindex="-1">2.3 以函数执行 进行测试 <a class="header-anchor" href="#_2-3-以函数执行-进行测试" aria-hidden="true">#</a></h3><p>OTSU</p><blockquote><blockquote><p>OTSU(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif&#39;,&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\OTSU_Result\\OTSU_Res.tif&#39;) 阈值Th=36.000000</p></blockquote></blockquote><p>\` ans =</p><pre><code>36
</code></pre><blockquote><blockquote></blockquote></blockquote><p>CVA CVA(&#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t131.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t132.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t133.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t134.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t135.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t136.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t137.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t181.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t182.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t183.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t184.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t185.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t186.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\data\\t187.tif&#39;, &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_Result\\CVA_Res.tif&#39;) \`</p><h2 id="_3-mcc编译jar" tabindex="-1">3 mcc编译jar <a class="header-anchor" href="#_3-mcc编译jar" aria-hidden="true">#</a></h2><h3 id="_3-1成功运行后-对其进行打包" tabindex="-1">3.1成功运行后 对其进行打包 <a class="header-anchor" href="#_3-1成功运行后-对其进行打包" aria-hidden="true">#</a></h3><p><code>mcc -W &#39;java:matlab.OTSU,Matlab&#39; -a &#39;D:/ILCS4MatlabService/CVA-OSTU/OTSU_mcc*&#39; -d &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\&#39; OTSU.m</code></p><p><code> mcc -W &#39;java:matlab.CVA,Matlab&#39; -a &#39;D:/ILCS4MatlabService/CVA-OSTU/CVA_mcc*&#39; -d &#39;D:\\ILCS4MatlabService\\CVA-OSTU\\CVA_mcc&#39; CVA.m</code></p><h3 id="_3-2-打包内容" tabindex="-1">3.2 打包内容 <a class="header-anchor" href="#_3-2-打包内容" aria-hidden="true">#</a></h3><p>jar包get</p><h2 id="_4-利用52n包装算法" tabindex="-1">4 利用52N包装算法 <a class="header-anchor" href="#_4-利用52n包装算法" aria-hidden="true">#</a></h2><h3 id="_4-1-新建一个java文件" tabindex="-1">4.1 新建一个java文件 <a class="header-anchor" href="#_4-1-新建一个java文件" aria-hidden="true">#</a></h3><h3 id="_4-2-将打包算法copy到项目的lib目录下" tabindex="-1">4.2 将打包算法copy到项目的lib目录下 <a class="header-anchor" href="#_4-2-将打包算法copy到项目的lib目录下" aria-hidden="true">#</a></h3><h3 id="_4-3-注册-算法" tabindex="-1">4.3 “注册”算法 <a class="header-anchor" href="#_4-3-注册-算法" aria-hidden="true">#</a></h3><p>打开MatlabRepository文件 添加</p><p><code>private final Map&lt;String, OTSUAlgorithm&gt; OTSUAlgor = new HashMap&lt;&gt;(8);</code></p><p><code>else if(processId.equals(&quot;matlab.OSTU&quot;)){ OTSUAlgor.put(processId,new OTSUAlgorithm(processId, jarDir + name + &quot;.jar&quot;, methodName)); }</code></p><p><code>case &quot;matlab.OTSU&quot; : return OTSUAlgor.get(processID);</code></p><p><code>case &quot;matlab.OTSU&quot; : return OTSUAlgor.get(processID).getDescription();</code></p><p><code>case &quot;matlab.OTSU&quot; : return OTSUAlgor.containsKey(processID);</code></p><p><a href="http://localhost:8081/wps/matlab/pushfakeAlgor?name=OTSU&amp;processId=matlab.OTSU&amp;methodName=OTSU" target="_blank" rel="noreferrer"><a href="http://localhost:8081/wps/matlab/pushfakeAlgor?name=OTSU&amp;processId=matlab.OTSU&amp;methodName=OTSU" target="_blank" rel="noreferrer">http://localhost:8081/wps/matlab/pushfakeAlgor?name=OTSU&amp;processId=matlab.OTSU&amp;methodName=OTSU</a></a></p><h3 id="_4-4-getcapabilities-查看是否注册" tabindex="-1">4.4 GetCapabilities 查看是否注册 <a class="header-anchor" href="#_4-4-getcapabilities-查看是否注册" aria-hidden="true">#</a></h3><h3 id="_4-5-执行wps算法服务" tabindex="-1">4.5 执行wps算法服务 <a class="header-anchor" href="#_4-5-执行wps算法服务" aria-hidden="true">#</a></h3><h4 id="_4-5-1-if-执行报错" tabindex="-1">4.5.1 if 执行报错 <a class="header-anchor" href="#_4-5-1-if-执行报错" aria-hidden="true">#</a></h4><h4 id="_4-5-2-添加jar到-springboot-模块中" tabindex="-1">4.5.2 添加jar到 springboot 模块中 <a class="header-anchor" href="#_4-5-2-添加jar到-springboot-模块中" aria-hidden="true">#</a></h4><h3 id="_4-7-服务执行代码" tabindex="-1">4.7 服务执行代码 <a class="header-anchor" href="#_4-7-服务执行代码" aria-hidden="true">#</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">github</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">aseara</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">matlab</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mathworks</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">toolbox</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">javabuilder</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">internal</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">MWFunctionSignature</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">algorithm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">annotation</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">data</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">GenericFileData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">data</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">binding</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">complex</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">GenericFileDataBinding</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">server</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">AbstractAnnotatedAlgorithm</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">server</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">algorithm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">test</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">EchoProcess</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">slf4j</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Logger</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">slf4j</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">LoggerFactory</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">File</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">lang</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">reflect</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Method</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">net</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">URL</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">net</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">URLClassLoader</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">text</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">SimpleDateFormat</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">ArrayList</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Date</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">UUID</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * desc: &lt;br /&gt;</span></span>
<span class="line"><span style="color:#676E95;"> * Date: 2021/11/18 &lt;br/&gt;</span></span>
<span class="line"><span style="color:#676E95;"> *</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@author</span><span style="color:#676E95;"> wanghaihang</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Algorithm</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">version</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.1.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">identifier</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">matlab.OTSU</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">title</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">matlab.OTSU</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">abstrakt</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">This is OTSU image processing algorithm.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">//@Slf4j</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">OTSUAlgorithm</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">AbstractAnnotatedAlgorithm</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> processId</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> jarPath</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> methodName</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">//    private String threshold;</span></span>
<span class="line"><span style="color:#676E95;">//    public GenericFileData result;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">GenericFileData</span><span style="color:#A6ACCD;"> source</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">final</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">MWFunctionSignature</span><span style="color:#A6ACCD;"> sOTSUSignature </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MWFunctionSignature</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">OTSU</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">final</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Logger</span><span style="color:#A6ACCD;"> log </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> LoggerFactory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLogger</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">EchoProcess</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> literalInput</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> literalOutput</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">SuppressWarnings</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unused</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">OTSUAlgorithm</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">OTSUAlgorithm</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">processId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">jarPath</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">methodName</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Init OTSUAlgorithm  MatlabAlgorithm()</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">processId </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> processId</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">jarPath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">file:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> jarPath</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">methodName </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> methodName</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">传入的方法名：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">methodName</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComplexDataInput</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">identifier</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">source</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">binding</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> GenericFileDataBinding</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">SuppressWarnings</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unused</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setData</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">GenericFileData</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">source </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> data</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">LiteralDataOutput</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">identifier</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">literalOutput</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getLiteralOutput</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> literalOutput</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">//    @LiteralDataInput(identifier = &quot;literalInput&quot;, minOccurs = 0, maxOccurs = 1)</span></span>
<span class="line"><span style="color:#676E95;">//    public void setLiteralInput(List&lt;String&gt; literalInput) { this.literalInput = literalInput; }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Execute</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">SuppressWarnings</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unused</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">this is OTSU</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">File</span><span style="color:#A6ACCD;"> f </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> source</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBaseFile</span><span style="color:#89DDFF;">(false);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> uuid </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> UUID</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">randomUUID</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">File</span><span style="color:#A6ACCD;"> r</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            r </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> File</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createTempFile</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">uuid</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.tif</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span><span style="color:#676E95;">//创建临时文件</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">throw</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RuntimeException</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;">             * 生成随机图片文件名，&quot;年月日时分秒&quot;格式</span></span>
<span class="line"><span style="color:#676E95;">             */</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">Date</span><span style="color:#A6ACCD;"> date </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Date</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">System</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">currentTimeMillis</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">SimpleDateFormat</span><span style="color:#A6ACCD;"> simpleDateFormat </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SimpleDateFormat</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yyyyMMddHHmmss</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fileName </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> simpleDateFormat</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">format</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">date</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> outputfile </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">E:/Tomcat/apache-tomcat-9.0.34/webapps/ILCSData/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">fileName</span><span style="color:#89DDFF;">+</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.tif</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> jarPath1</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">file:///D://研究生学习/4系统开发/wps-52n/lib</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">load jar: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> jarPath1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;">             * 类加载机制-加载外部jar包</span></span>
<span class="line"><span style="color:#676E95;">             */</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">URLClassLoader</span><span style="color:#A6ACCD;"> classLoader </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URLClassLoader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">URL</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">jarPath1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">getClass</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">getClassLoader</span><span style="color:#89DDFF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">Class</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">?</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> runClazz </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> classLoader</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">loadClass</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">processId </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.Matlab</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> runObj </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> runClazz</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConstructor</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">newInstance</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">//                log.info(&quot;输入阈值 ： {}&quot; ,literalInput.get(0));</span></span>
<span class="line"><span style="color:#A6ACCD;">                log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">进程id ： {}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">processId</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;">//                String thres = literalInput.get(0);</span></span>
<span class="line"><span style="color:#676E95;">//            Method method = runClazz.getMethod(this.methodName, List.class,List.class);</span></span>
<span class="line"><span style="color:#676E95;">//            List list=new ArrayList();</span></span>
<span class="line"><span style="color:#676E95;">//            list.add(f.getAbsolutePath());</span></span>
<span class="line"><span style="color:#676E95;">//            List list1=new ArrayList();</span></span>
<span class="line"><span style="color:#676E95;">//            list1.add(outputfile);</span></span>
<span class="line"><span style="color:#676E95;">//</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">Method</span><span style="color:#A6ACCD;"> method </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> runClazz</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMethod</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">methodName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> int</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#89DDFF;">[].</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">参数1：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">f</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getAbsolutePath</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">参数2：</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">outputfile</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">            method</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">invoke</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">runObj</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">f</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getAbsolutePath</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;">outputfile</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">String</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">valueOf</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">method</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">                </span><span style="color:#676E95;">//给客户端返回一个json对象</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#C792EA;">StringBuilder</span><span style="color:#A6ACCD;"> sb </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">StringBuilder</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">code</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">200</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">filename</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">fileName</span><span style="color:#89DDFF;">+</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.tif</span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                sb</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">]</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                literalOutput </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> String</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">valueOf</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">sb</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">throw</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RuntimeException</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">4.8</span><span style="color:#A6ACCD;">　多个图像输入</span></span>
<span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">server</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">algorithm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">test</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">File</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">IOException</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">util</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">algorithm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">annotation</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Algorithm</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">algorithm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">annotation</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">ComplexDataInput</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">algorithm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">annotation</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">ComplexDataOutput</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">algorithm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">annotation</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Execute</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">data</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">GenericFileData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">data</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">binding</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">complex</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">GenericFileDataBinding</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">n52</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">server</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">AbstractAnnotatedAlgorithm</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">slf4j</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Logger</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">slf4j</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">LoggerFactory</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Algorithm</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">version</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">title</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">for testing multiple inputs by reference</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MultiReferenceInputAlgorithm</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">AbstractAnnotatedAlgorithm</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Logger</span><span style="color:#A6ACCD;"> LOGGER </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> LoggerFactory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLogger</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">MultiReferenceInputAlgorithm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MultiReferenceInputAlgorithm</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        super</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">GenericFileData</span><span style="color:#A6ACCD;"> result</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">GenericFileData</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> data</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComplexDataOutput</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">identifier</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">result</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">binding</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> GenericFileDataBinding</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">GenericFileData</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getResult</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> result</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">ComplexDataInput</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">identifier</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">data</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">binding</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> GenericFileDataBinding</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">minOccurs</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">maxOccurs</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setData</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">GenericFileData</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">data </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> data</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Execute</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">runProcess</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">GenericFileData</span><span style="color:#A6ACCD;"> gfd </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">File</span><span style="color:#A6ACCD;"> f </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gfd</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBaseFile</span><span style="color:#89DDFF;">(false);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">result </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GenericFileData</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">f</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> gfd</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMimeType</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">LOGGER</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMessage</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="_5-测试服务接口" tabindex="-1">5 测试服务接口 <a class="header-anchor" href="#_5-测试服务接口" aria-hidden="true">#</a></h2><h3 id="_5-1-注册算法" tabindex="-1">5.1 注册算法 <a class="header-anchor" href="#_5-1-注册算法" aria-hidden="true">#</a></h3><p>post： <a href="http://localhost:8081/wps/matlab/pushfakeAlgor?name=OTSU&amp;processId=matlab.OTSU&amp;methodName=OTSU&amp;jarPath=file:///D://研究生学习/4系统开发/wps-52n/lib" target="_blank" rel="noreferrer"><a href="http://localhost:8081/wps/matlab/pushfakeAlgor?name=OTSU&amp;processId=matlab.OTSU&amp;methodName=OTSU&amp;jarPath=file:///D://%E7%A0%94%E7%A9%B6%E7%94%9F%E5%AD%A6%E4%B9%A0/4%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91/wps-52n/lib" target="_blank" rel="noreferrer">http://localhost:8081/wps/matlab/pushfakeAlgor?name=OTSU&amp;processId=matlab.OTSU&amp;methodName=OTSU&amp;jarPath=file:///D://研究生学习/4系统开发/wps-52n/lib</a></a></p><h3 id="_5-2-getcapabilities" tabindex="-1">5.2 getcapabilities <a class="header-anchor" href="#_5-2-getcapabilities" aria-hidden="true">#</a></h3><p><code>http://localhost:8081/wps/WebProcessingService?service=WPS&amp;Request=GetCapabilities&amp;AcceptVersions=1.0.0 </code></p><h3 id="_5-3-执行测试-execute" tabindex="-1">5.3 执行测试 Execute <a class="header-anchor" href="#_5-3-执行测试-execute" aria-hidden="true">#</a></h3><p>post请求： <code>http://localhost:8081/wps/WebProcessingService</code> raw：</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> standalone</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yes</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Execute</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">service</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">WPS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">wps</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.opengis.net/wps/1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">ows</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.opengis.net/ows/1.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">xlink</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.w3.org/1999/xlink</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">schemaLocation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.opengis.net/wps/1.0.0</span></span>
<span class="line"><span style="color:#C3E88D;">  http://schemas.opengis.net/wps/1.0.0/wpsExecute_request.xsd</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">ows</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Identifier</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">matlab.OTSU</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">ows</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Identifier</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">DataInputs</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Input</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">ows</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Identifier</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">ns1</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.opengis.net/ows/1.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">source</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">ows</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Identifier</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Reference</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xlink</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:8080/ILCSData/CVA_Result/CVA_Res.tif</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">mimeType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">image/tiff</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Input</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">DataInputs</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">ResponseForm</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">RawDataOutput</span><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">asReference</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">false</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">  &gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">ows</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Identifier</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">literalOutput</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">ows</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Identifier</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">RawDataOutput</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">ResponseForm</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">wps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">Execute</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h2 id="_6-界面化" tabindex="-1">6 界面化 <a class="header-anchor" href="#_6-界面化" aria-hidden="true">#</a></h2><p>接口调用、常规请求如Ajax、Axios封装xml进行请求</p>`,57),e=[o];function t(c,r,D,y,C,A){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{i as __pageData,u as default};
