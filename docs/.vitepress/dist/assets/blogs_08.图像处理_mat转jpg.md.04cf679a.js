import{_ as s,o as a,c as n,d as p}from"./app.ae19f29a.js";const i=JSON.parse('{"title":"mat转图片格式","description":"","frontmatter":{},"headers":[{"level":2,"title":"mat转png","slug":"mat转png","link":"#mat转png","children":[]},{"level":2,"title":"批量处理","slug":"批量处理","link":"#批量处理","children":[]}],"relativePath":"blogs/08.图像处理/mat转jpg.md"}'),l={name:"blogs/08.图像处理/mat转jpg.md"},o=p(`<h1 id="mat转图片格式" tabindex="-1">mat转图片格式 <a class="header-anchor" href="#mat转图片格式" aria-hidden="true">#</a></h1><h2 id="mat转png" tabindex="-1">mat转png <a class="header-anchor" href="#mat转png" aria-hidden="true">#</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> cv2</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> scipy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">io</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> scio</span></span>
<span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> PIL </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> Image</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> numpy </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> np</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> matplotlib</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">pyplot</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> plt</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> os</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># 数据矩阵转图片的函数</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MatrixToImage</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    data </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> data </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">255</span></span>
<span class="line"><span style="color:#A6ACCD;">    new_im </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Image</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fromarray</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">astype</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">np</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">uint8</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> new_im</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># 添加路径，文件夹下存放多个.mat文件</span></span>
<span class="line"><span style="color:#676E95;"># 两个文件夹一个放.mat,一个放转换好的图片</span></span>
<span class="line"><span style="color:#A6ACCD;">datafolder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/Users/wanghaihang/Downloads/MtS-WH/test/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">savefolder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/Users/wanghaihang/Downloads/MtS-WH/test/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listdir</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">datafolder</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">os</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">splitext</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">100007.mat</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#676E95;"># 这一步用于测试你是否正确设置了路径，也展示了splitxt函数的结果</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># 先取一个文件做实验，接下来在控制台一行一行运行</span></span>
<span class="line"><span style="color:#A6ACCD;">each_mat</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hanyang20009label.mat</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> second_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">splitext</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">each_mat</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 拆分.mat文件的前后缀名字，</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">each_mat </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">datafolder</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> each_mat</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># print(each_mat)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 校验步骤，输出应该是路径</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">array_struct </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">loadmat</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">each_mat</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">array_struct</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 校验步骤，输出的应该是一个结构体，然后查看你的控制台，看数据被存在了哪个字段里</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 我的数据被放在了result里，所以下面填result</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">array_data </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> array_struct</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hanyang2009</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># 取出需要的数字矩阵部分</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># print(array_data)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 校验步骤，看是否正常读出了数据</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">new_im </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MatrixToImage</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">array_data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># 调用函数</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">imshow</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">array_data</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">cmap</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">cm</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">gray</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">interpolation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nearest</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">new_im</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">show</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">new_im</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">savefolder</span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;">first_name </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.jpg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># 保存图片</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h2 id="批量处理" tabindex="-1">批量处理 <a class="header-anchor" href="#批量处理" aria-hidden="true">#</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> cv2</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> scipy</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">io</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> scio</span></span>
<span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> PIL </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> Image</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> numpy </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> np</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> matplotlib</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">pyplot</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> plt</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> os</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#676E95;"># 数据矩阵转图片的函数</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MatrixToImage</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    data </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> data </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">255</span></span>
<span class="line"><span style="color:#A6ACCD;">    new_im </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Image</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fromarray</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">astype</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">np</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">uint8</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> new_im</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#676E95;"># 添加路径，metal文件夹下存放mental类的特征的多个.mat文件</span></span>
<span class="line"><span style="color:#A6ACCD;">datafolder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:/新建文件夹/RINDNet-main/run/rindnet/depth/mat</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">savefolder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:/新建文件夹/RINDNet-main/run/rindnet/depth/out/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listdir</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">datafolder</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;"># print(os.path.splitext(&#39;100007.mat&#39;))</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> each_mat </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 先取一个文件做实验</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># each_mat=&#39;100007.mat&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> second_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">splitext</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">each_mat</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 拆分.mat文件的前后缀名字，</span></span>
<span class="line"><span style="color:#A6ACCD;">    each_mat </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">datafolder</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> each_mat</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># print(each_mat)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 校验步骤，输出应该是文件名</span></span>
<span class="line"><span style="color:#A6ACCD;">    array_struct </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">loadmat</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">each_mat</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># print(array_struct)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 校验步骤</span></span>
<span class="line"><span style="color:#A6ACCD;">    array_data </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> array_struct</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">result</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># 取出需要的数字矩阵部分</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># print(array_data)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># 校验步骤</span></span>
<span class="line"><span style="color:#A6ACCD;">    new_im </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MatrixToImage</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">array_data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># 调用函数</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">imshow</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">array_data</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">cmap</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">cm</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">gray</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">interpolation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">nearest</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># new_im.show()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># print(first_name)</span></span>
<span class="line"><span style="color:#A6ACCD;">    new_im</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">savefolder</span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;">first_name </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.jpg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># 保存图片</span></span>
<span class="line"></span></code></pre></div>`,5),e=[o];function t(c,r,D,F,y,A){return a(),n("div",null,e)}const m=s(l,[["render",t]]);export{i as __pageData,m as default};
